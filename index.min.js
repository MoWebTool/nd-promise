/*!
 * ND-PROMISE v3.0.2
 * (c) 2016 crossjs
 * Released under the MIT License.
 */
var ndpromise=function(){"use strict";function t(t){var n=this;if("object"!==s(this))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._progress=null,this._deferreds=[],f(t,function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];e.apply(n,r)},function(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];r.apply(n,e)},function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];o.apply(n,e)})}function n(t){var n=this;return null===this._state?(this._deferreds.push(t),void(t.onProgress&&null!==this._progress&&setImmediate(function(){t.onProgress(n._progress)}))):void setImmediate(function(){var e=n._state?t.onFulfilled:t.onRejected;if(null===e)return void(n._state?t.resolve:t.reject)(n._value);var r=void 0;try{r=e(n._value)}catch(n){return void t.reject(n)}t.resolve(r)})}function e(t){var n=this;try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===("undefined"==typeof t?"undefined":s(t))||"function"==typeof t)){var u=function(){var i=t.then;if("function"==typeof i)return f(function(){for(var n=arguments.length,e=Array(n),r=0;r<n;r++)e[r]=arguments[r];i.apply(t,e)},function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];e.apply(n,r)},function(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];r.apply(n,e)},function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];o.apply(n,e)}),{v:void 0}}();if("object"===("undefined"==typeof u?"undefined":s(u)))return u.v}this._state=!0,this._value=t,i.call(this)}catch(t){r.call(this,t)}}function r(t){this._state=!1,this._value=t,i.call(this)}function o(t){this._progress=t,i.call(this,!0)}function i(t){for(var e=0,r=this._deferreds.length;e<r;e++)n.call(this,this._deferreds[e]);t||(this._deferreds=null)}function u(t,n,e,r,o,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.onProgress="function"==typeof e?e:null,this.resolve=r,this.reject=o,this.notify=i}function f(t,n,e,r){var o=!1;try{t(function(t){o||(o=!0,n(t))},function(t){o||(o=!0,e(t))},function(t){o||r(t)})}catch(t){if(o)return;o=!0,e(t)}}!function(t,n){function e(t){return d[p]=r.apply(n,t),p++}function r(t){var e=[].slice.call(arguments,1);return function(){"function"==typeof t?t.apply(n,e):new Function(""+t)()}}function o(t){if(y)setTimeout(r(o,t),0);else{var n=d[t];if(n){y=!0;try{n()}finally{i(t),y=!1}}}}function i(t){delete d[t]}function u(){h=function(){var t=e(arguments);return process.nextTick(r(o,t)),t}}function f(){if(t.postMessage&&!t.importScripts){var n=!0,e=t.onmessage;return t.onmessage=function(){n=!1},t.postMessage("","*"),t.onmessage=e,n}}function s(){var n="setImmediate$"+Math.random()+"$",r=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(n)&&o(+e.data.slice(n.length))};t.addEventListener?t.addEventListener("message",r,!1):t.attachEvent("onmessage",r),h=function(){var r=e(arguments);return t.postMessage(n+r,"*"),r}}function c(){var t=new MessageChannel;t.port1.onmessage=function(t){var n=t.data;o(n)},h=function(){var n=e(arguments);return t.port2.postMessage(n),n}}function a(){var t=v.documentElement;h=function(){var n=e(arguments),r=v.createElement("script");return r.onreadystatechange=function(){o(n),r.onreadystatechange=null,t.removeChild(r),r=null},t.appendChild(r),n}}function l(){h=function(){var t=e(arguments);return setTimeout(r(o,t),0),t}}if(!t.setImmediate){var h,p=1,d={},y=!1,v=t.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(t);g=g&&g.setTimeout?g:t,"[object process]"==={}.toString.call(t.process)?u():f()?s():t.MessageChannel?c():v&&"onreadystatechange"in v.createElement("script")?a():l(),g.setImmediate=h,g.clearImmediate=i}}("undefined"==typeof self?"undefined"==typeof global?void 0:global:self);var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(n){return this.then(function(e){return t.resolve(n()).then(function(){return e})},function(e){return t.resolve(n()).then(function(){throw e})})},t.prototype.progress=function(t){return this.then(null,null,t)},t.prototype.then=function(e,r,o){var i=this;return new t(function(t,f,s){n.call(i,new u(e,r,o,t,f,s))})},t.resolve=function(n){return n&&"object"===("undefined"==typeof n?"undefined":s(n))&&n.constructor===t?n:new t(function(t){return t(n)})},t.reject=function(n){return new t(function(t,e){return e(n)})},t.notify=function(n){return new t(function(t,e,r){return r(n)})},t.all=function(n){return new t(function(t,e,r){function o(u,f){try{if(f&&("object"===("undefined"==typeof f?"undefined":s(f))||"function"==typeof f)){var c=f.then;if("function"==typeof c)return void c.call(f,function(t){o(u,t)},e,r)}n[u]=f,0===--i&&t(n)}catch(t){e(t)}}if(0===n.length)return t([]);for(var i=n.length,u=0;u<n.length;u++)o(u,n[u])})},t.race=function(n){return new t(function(e,r,o){for(var i=0,u=n.length;i<u;i++)t.resolve(n[i]).then(e,r,o)})},t}();